This is an implementation from https://andrewlock.net/creating-a-simple-moving-average-calculator-in-csharp-2-making-the-calculator-thread-safe/